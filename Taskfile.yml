version: '3'

tasks:
  clean:
    cmds:
      - rm -rf public resources

  theme:restore:
    cmds:
      - git submodule update --recursive

  theme:update:
    cmds:
      - git submodule update --remote

  gen-highlight-css:
    cmds:
      - hugo gen chromastyles --style=dracula | tee ./static/css/highlight.css

  build:
    deps:
      - clean
      - theme:restore
    cmds:
      - task: gen-highlight-css
      - hugo --config config.toml,config.prod.toml

  start:
    cmds:
      - hugo --config config.toml,config.dev.toml server
